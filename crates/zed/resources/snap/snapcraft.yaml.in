name: zed
title: Zed
base: core24
version: "$RELEASE_VERSION"
summary: A code editor designed for high-performance collaboration with humans and AI.
description: |
  Zed is a next-generation code editor designed for high-performance collaboration with humans and AI.
  It's open source and written in Rust.
grade: stable
confinement: classic
compression: lzo
icon: crates/zed/resources/app-icon.png
website: https://zed.dev/
source-code: https://github.com/zed-industries/zed
issues: https://github.com/zed-industries/zed/issues
contact: https://zed.dev/community-links#support-and-feedback

parts:
  zed:
    plugin: dump
    source: "https://github.com/zed-industries/zed/releases/download/v$RELEASE_VERSION/zed-linux-x86_64.tar.gz"

    organize:
      share/applications/zed.desktop: snap/gui/zed.desktop
      share/icons/hicolor/512x512/apps/zed.png: snap/gui/zed.png

      # core24 does not have OpenSSL 1.1, so use these from the tarball.
      lib/libcrypto.so.1.1: usr/lib/x86_64-linux-gnu/
      lib/libssl.so.1.1: usr/lib/x86_64-linux-gnu/

      # These renames seem to not be necessary, but it's tidier.
      bin: usr/bin
      libexec: usr/libexec

    stage-packages:
      - libasound2t64
      - libvulkan1
      - libxcb1
      - libxkbcommon0
      - libxkbcommon-x11-0

    build-attributes:
      - enable-patchelf

    prime:
      # Omit unneeded files from the tarball
      - -lib
      - -licenses.md
      - -share

      # Omit unneeded files from stage-packages
      - -etc
      - -usr/share/doc
      - -usr/share/lintian
      - -usr/share/man

apps:
  zed:
    command: usr/bin/zed
    common-id: dev.zed.Zed
